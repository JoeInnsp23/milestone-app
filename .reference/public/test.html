<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Test</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/dashboard.js"></script>
</head>
<body class="dashboard-loaded">
    <div id="dashboard-container"></div>

    <script>
        // Test with sample data
        const sampleData = {
            "data": [
                {
                    "Reports": [{
                        "ReportTitles": ["Profit & Loss", "Build By Milestone Ltd", "Test Project 1", "1 January 2024 to 31 December 2024"],
                        "Rows": [
                            {
                                "RowType": "Section",
                                "Title": "Income",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Sales"},
                                            {"Value": "150000.00"}
                                        ]
                                    },
                                    {
                                        "RowType": "SummaryRow",
                                        "Cells": [
                                            {"Value": "Total Income"},
                                            {"Value": "150000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "Less Cost of Sales",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Materials and small tools"},
                                            {"Value": "50000.00"}
                                        ]
                                    },
                                    {
                                        "RowType": "SummaryRow",
                                        "Cells": [
                                            {"Value": "Total Cost of Sales"},
                                            {"Value": "50000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Gross Profit"},
                                            {"Value": "100000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "Less Operating Expenses",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Sundry expenses"},
                                            {"Value": "20000.00"}
                                        ]
                                    },
                                    {
                                        "RowType": "SummaryRow",
                                        "Cells": [
                                            {"Value": "Total Operating Expenses"},
                                            {"Value": "20000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Net Profit"},
                                            {"Value": "80000.00"}
                                        ]
                                    }
                                ]
                            }
                        ]
                    }]
                },
                {
                    "Reports": [{
                        "ReportTitles": ["Profit & Loss", "Build By Milestone Ltd", "Test Project 2", "1 January 2024 to 31 December 2024"],
                        "Rows": [
                            {
                                "RowType": "Section",
                                "Title": "Income",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Sales"},
                                            {"Value": "75000.00"}
                                        ]
                                    },
                                    {
                                        "RowType": "SummaryRow",
                                        "Cells": [
                                            {"Value": "Total Income"},
                                            {"Value": "75000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "Less Cost of Sales",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Materials and small tools"},
                                            {"Value": "80000.00"}
                                        ]
                                    },
                                    {
                                        "RowType": "SummaryRow",
                                        "Cells": [
                                            {"Value": "Total Cost of Sales"},
                                            {"Value": "80000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Gross Profit"},
                                            {"Value": "-5000.00"}
                                        ]
                                    }
                                ]
                            },
                            {
                                "RowType": "Section",
                                "Title": "",
                                "Rows": [
                                    {
                                        "RowType": "Row",
                                        "Cells": [
                                            {"Value": "Net Profit"},
                                            {"Value": "-5000.00"}
                                        ]
                                    }
                                ]
                            }
                        ]
                    }]
                }
            ]
        };

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Load theme preference
            loadThemePreference();

            // Process and render the data
            const projectsData = processWebhookData(sampleData);
            renderDashboard(projectsData);
        });
    </script>
</body>
</html>